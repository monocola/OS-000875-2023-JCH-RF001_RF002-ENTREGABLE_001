<div style="display: flex">
  <span class ="subtitle" style="flex: 1 0">{{ this.title }}</span>
  <mat-paginator
    showFirstLastButtons
    [pageSizeOptions]="paginationSizes"
    [pageSize]="defaultPageSize"
    [pageIndex]="pageIndex"
    [length]="tamanio"
    (page)="pageEvent.emit($event)"
  >
  </mat-paginator>
</div>

<table
  mat-table
  aria-describedby="material-table"
  class="mat-elevation-z7 mt-2"
  matSort
  [dataSource]="tableDataSource"
  (matSortChange)="sortTable($event)"
>
<ng-container [matColumnDef]="'codigoConvocatoria'">
  <th
    scope="col"
    style="width: 10%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'codigoConvocatoria'"
    [arrowPosition]="'after'"
  >
    CÓDIGO
  </th>
  <td mat-cell *matCellDef="let element" class="text-left">
    <div class="fs-13 statusDatosPersonales">
      <span class="text-info text-uppercase" >
        <a class=" cursor-pointer" (click)="openDetalle(element)">{{ element.codigoConvocatoria | titlecase }}</a>
      </span>
    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'cronograma'">
  <th
    scope="col"
    style="width: 10%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'cronograma'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    CRONOGRAMA
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{element.periodoIniEtapa + '-' + element.periodoFinEtapa}}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'regimen'">
  <th
    scope="col"
    style="width: 15%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'regimen'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    RÉGIMEN
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{ element.regimen | titlecase }}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'nroVacantes'">
  <th
    scope="col"
    style="width: 5%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'nroVacantes'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    VACANT.
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{ element.nroVacantes }}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'nombreGestor'">
  <th
    scope="col"
    style="width: 10%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'nombreGestor'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    GESTOR ORH
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{ element.nombreGestor || '' }}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'nombreCoordinador'">
  <th
    scope="col"
    style="width: 10%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'nombreCoordinador'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    COORDINADOR
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{ element.nombreCoordinador || '' }}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'nroPostPorConvo'">
  <th
    scope="col"
    style="width: 5%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'nroPostPorConvo'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    POSTUL.
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{ element.nroPostPorConvo }}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'nroPostContratados'">
  <th
    scope="col"
    style="width: 5%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'nroPostContratados'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    CALIF.
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{ element.nroPostContratados }}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'etapaConvocatoria'">
  <th
    scope="col"
    style="width: 10%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'etapaConvocatoria'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    ETAPA
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{ element.etapaConvocatoria || '' }}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'perfiles'">
  <th
    scope="col"
    style="width: 5%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'perfiles'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    PERFILES
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{ 0 }}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'remuneracion'">
  <th
    scope="col"
    style="width: 10%"
    mat-header-cell
    *matHeaderCellDef
    [mat-sort-header]="'remuneracion'"
    [arrowPosition]="'after'"
    class="text-center"
  >
    RANGO SALARIAL
  </th>
  <td mat-cell *matCellDef="let element" class="text-center">
    <div class="fs-13" >
      <span>
        {{ element.remuneracion }}
      </span>

    </div>
  </td>
</ng-container>

<ng-container [matColumnDef]="'estadoConvocatoria'">
    <th
      scope="col"
      style="width: 10%"
      mat-header-cell
      *matHeaderCellDef
      [arrowPosition]="'after'"
      [mat-sort-header]="'estadoConvocatoria'"
    >
      Estado
    </th>
    <td mat-cell *matCellDef="let element" class="text-center">
      <div
        class="fs-11 statusSpan"
        [ngClass]="{
          statusProceso: element.estadoConvocatoriaId === const.EST_CONV_PROC,
          statusDesierta:
            element.estadoConvocatoriaId === const.EST_CONV_DES,
          statusCancelado:
            element.estadoConvocatoriaId === const.EST_CONV_CANCEL,
          statusCulminado: element.estadoConvocatoriaId === const.EST_CONV_CULM,
          statusGenerado: element.estadoConvocatoriaId === const.EST_CONV_GENER
        }"
      >
        <span>
          {{ element.estadoConvocatoria | titlecase }}
        </span>
      </div>
    </td>
  </ng-container>

  <ng-container
    *ngFor="let tableColumn of tableColumns"
    [matColumnDef]="tableColumn.name"
  >
    <th
      *matHeaderCellDef
      scope="col"
      mat-header-cell
      [mat-sort-header]="tableColumn.name"
      [arrowPosition]="tableColumn.position === 'right' ? 'before' : 'after'"
      [ngStyle]="{
        width: tableColumn.width ? tableColumn.width : 'auto'
      }"
    >
      {{ tableColumn.name }}
    </th>

    <td
      *matCellDef="let element"
      mat-cell
      [class.text-right]="tableColumn.position == 'right'"
    >
      <span
        [class]="fontSize"
        [ngStyle]="{ color: element | colorPipeGetter: tableColumn.dataKey }"
      >
        {{ element | dataPropertyGetter: tableColumn.dataKey }}
      </span>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
</table>

<div
  class="p-3 mat-elevation-z1"
  *ngIf="this.tableDataSource.filteredData.length === 0"
  style="background-color: white"
>
  No se encontraron resultados
</div>

<div class="row px-3 mt-3" *ngIf="showDownloadButton">
  <span style="flex: 1 0"></span>
  <button
    class="btn-excel px-4 py-1"
    mat-stroked-button
    (click)="exportData()"
    [disabled]="this.tableDataSource.filteredData.length === 0"
  >
    <span> Descargar Excel </span>
    <nb-icon icon="descargar"></nb-icon>
  </button>
</div>
